package prefixSum

/*
*
ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªæ•´æ•° k ï¼Œè¯·ä½ ç»Ÿè®¡å¹¶è¿”å› è¯¥æ•°ç»„ä¸­å’Œä¸º k çš„å­æ•°ç»„çš„ä¸ªæ•° ã€‚

å­æ•°ç»„æ˜¯æ•°ç»„ä¸­å…ƒç´ çš„è¿ç»­éç©ºåºåˆ—ã€‚
ä¹Ÿå°±æ˜¯é•¿åº¦å¯èƒ½ä¸º 1 2 3 4
é‚£è¿™ç§æƒ…å†µä¸‹ï¼Œ
æ’åº+åŒæŒ‡é’ˆä¼šæ¼ç®—ï¼Œé‚£å¦‚æœåŒé‡å¾ªç¯è¡Œå—ï¼Ÿå¥½åƒä¹Ÿä¸è¡Œï¼ŒåŒæŒ‡é’ˆå°±æ˜¯ä¸¤ä¸ªé•¿åº¦ä¸º 2 çš„å­åºåˆ—äº†ã€‚åªèƒ½ç®—è¿™ä¸ªç»“æœï¼Œç®—ä¸äº†åˆ«çš„

æƒ³ä¸å‡ºæ¥å°±å…ˆå»åƒé¥­

----- ğŸ…4 ------
å›æ¥ç»§ç»­
*/
func subarraySum(nums []int, k int) int {
	// å‰ç¼€å’Œ + å“ˆå¸Œè¡¨è®¡æ•°ï¼š
	// å¯¹äºä»»æ„ jï¼Œè‹¥å­˜åœ¨ i ä½¿å¾— prefix[j]-prefix[i]=kï¼Œåˆ™ nums[i:j] çš„å’Œä¸º kã€‚
	ans := 0
	prefix := 0
	// cnt := map[int]int{0: 1} è¡¨ç¤ºâ€œå‰ç¼€å’Œä¸º 0 å‡ºç°è¿‡ 1 æ¬¡â€ï¼ˆåœ¨æ•°ç»„å¼€å§‹ä¹‹å‰ï¼‰ã€‚
	//    è¿™æ ·å½“ prefix == k æ—¶ï¼ˆä¹Ÿå°±æ˜¯ä» 0..i è¿™æ®µå’Œä¸º kï¼‰ï¼Œå°±èƒ½æ­£ç¡®è®¡æ•°åˆ° 1ã€‚
	cnt := map[int]int{0: 1}

	for _, v := range nums {
		prefix += v
		ans += cnt[prefix-k]
		cnt[prefix]++
	}
	return ans
}

func subarraySum_b(nums []int, k int) int {
	sum := make([]int, len(nums)+1)
	// å¾—åˆ°å‰ç¼€å’Œ
	for i, v := range nums {
		sum[i+1] = sum[i] + v
	}
	ans := 0
	// ä½ ç°åœ¨çš„ç“¶é¢ˆä¸æ˜¯â€œé‡å¤è®¡ç®— sum[j]-sum[i]â€ï¼ˆè¿™å·²ç»æ˜¯ O(1) äº†ï¼‰ï¼Œè€Œæ˜¯â€œåŒºé—´æ•°é‡æœ¬èº«å°±æ˜¯ O(n^2)â€ã€‚
	//è¦æƒ³å¿«ï¼Œå°±ä¸èƒ½ æ˜¾å¼æšä¸¾æ‰€æœ‰åŒºé—´ã€‚
	/**
	for i := 0; i < len(nums); i++ {
		for j := i + 1; j < len(sum); j++ {
			if sum[j]-sum[i] == k {
				ans++
			}
		}
	}
	*/
	/**
	è¦æ‰¾s[j]-s[i] =k çš„[i,j] ä¸€å…±æœ‰å¤šå°‘å¯¹ï¼Ÿ
	æ¢ä¸€ä¸‹ï¼Œs[i]=s[j]-k è¿™å°±å¾ˆåƒä¸¤æ•°ä¹‹å’Œï¼Œä¸è¿‡é‚£é¢˜æ±‚çš„æ˜¯æœ‰è¿˜æ˜¯æ²¡æœ‰ï¼Œæœ‰ä¸€å¯¹å°±è¡Œäº†ï¼Œè¿™é¢˜æ±‚çš„æ˜¯æœ‰ï¼Œè¿˜è¦ç®—å‡ºæœ‰å¤šå°‘ä¸ªã€‚
	é‚£ä¹ˆå°±è½¬å˜æˆäº†ï¼Œæšä¸¾æ¯ä¸€ä¸ª j, éƒ½è¦æ‰¾å‰ç¼€å’Œä¸º s[j]-k çš„ä¸‹æ ‡æœ‰å¤šå°‘ä¸ª
	æ‰€ä»¥è¦é’ˆå¯¹å‰ç¼€å’Œè¿›è¡Œä¸€ä¸ªè®¡æ•°ç»Ÿè®¡ã€‚
	*/
	cnt := make(map[int]int)
	cnt[0] = 1

	for i := 0; i <= len(sum); i++ {
		ans += cnt[sum[i]-k]
		cnt[sum[i]]++
	}

	return ans
}
